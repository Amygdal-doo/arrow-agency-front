(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{75254:(e,r,t)=>{Promise.resolve().then(t.bind(t,50261))},50261:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(95155),a=t(91620),l=t(2615),i=t(76046),n=t(12115),o=t(27923),d=t(69606);let c=()=>{var e,r,t,l;let{profile:i,fetchProfile:c}=(0,a.x)(),{register:u,handleSubmit:h,setValue:g,formState:{errors:m,isSubmitting:p}}=(0,d.mN)({defaultValues:{phoneNumber:(null==i?void 0:i.phoneNumber)||"",address:(null==i?void 0:i.address)||"",firstName:(null==i?void 0:null===(e=i.user)||void 0===e?void 0:e.firstName)||"",lastName:(null==i?void 0:null===(r=i.user)||void 0===r?void 0:r.lastName)||""}});(0,n.useEffect)(()=>{var e,r;g("phoneNumber",(null==i?void 0:i.phoneNumber)||""),g("address",(null==i?void 0:i.address)||""),g("firstName",(null==i?void 0:null===(e=i.user)||void 0===e?void 0:e.firstName)||""),g("lastName",(null==i?void 0:null===(r=i.user)||void 0===r?void 0:r.lastName)||"")},[i,g]);let x=async e=>{console.log("data");try{await o.K.put("user/profile",{phoneNumber:e.phoneNumber,address:e.address,firstName:e.firstName,lastName:e.lastName}),c()}catch(e){console.log("Error updating profile",e)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Personal Information"}),(0,s.jsx)("div",{className:"h-px flex-1 bg-gray-700 mx-4"})]}),(0,s.jsxs)("form",{onSubmit:h(x),className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50 shadow-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{...u("firstName",{required:"First name is required"}),placeholder:"First Name",className:"w-full bg-gray-700/50 border border-gray-600/50 rounded-lg p-3 text-gray-300 placeholder-gray-500 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"}),m.firstName&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:m.firstName.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{placeholder:"Last Name",...u("lastName",{required:"Last name is required"}),className:"w-full bg-gray-700/50 border border-gray-600/50 rounded-lg p-3 text-gray-300 placeholder-gray-500 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"}),m.lastName&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:m.lastName.message})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{...u("phoneNumber",{required:"Phone number is required"}),placeholder:"Phone Number",className:"w-full bg-gray-700/50 border border-gray-600/50 rounded-lg p-3 text-gray-300 placeholder-gray-500 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"}),m.phoneNumber&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:m.phoneNumber.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{...u("address",{required:"Address is required"}),placeholder:"Address",className:"w-full bg-gray-700/50 border border-gray-600/50 rounded-lg p-3 text-gray-300 placeholder-gray-500 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"}),m.address&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:m.address.message})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,s.jsx)("div",{children:i&&(0,s.jsxs)("div",{className:"group bg-gray-800/30 backdrop-blur-sm rounded-lg p-3 border border-gray-700/50",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Created At"}),(0,s.jsx)("div",{className:"text-gray-300",children:new Date(null===(t=i.user)||void 0===t?void 0:t.createdAt).toLocaleDateString()})]})}),(0,s.jsx)("div",{children:i&&(0,s.jsxs)("div",{className:"group bg-gray-800/30 backdrop-blur-sm rounded-lg p-3 border border-gray-700/50",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Updated At"}),(0,s.jsx)("div",{className:"text-gray-300",children:new Date(null===(l=i.user)||void 0===l?void 0:l.updatedAt).toLocaleDateString()})]})})]}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-orange-600 to-orange-700 text-white p-3 rounded-lg font-medium hover:from-orange-700 hover:to-orange-800 transition-all duration-200 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Updating...":"Update Profile"})]})]})};var u=t(35482),h=t(5565);function g(){var e,r;let{data:t,status:d}=(0,l.useSession)(),g=(0,i.useRouter)(),{profile:m,fetchProfile:p}=(0,a.x)(),{applicants:x,page:f,setPage:v,pages:b,fetchApplicants:y}=(0,u.B)();(0,n.useEffect)(()=>{if("unauthenticated"===d){g.replace("/");return}y()},[d,t,g]);let[N,j]=(0,n.useState)(!1),w=async e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t)try{j(!0);let e=new FormData;e.append("file",t),await o.K.put("user/profile/company-logos",e,{headers:{"Content-Type":"multipart/form-data"}}),await p()}catch(e){console.error("Error uploading logo:",e)}finally{j(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-[#01070a] text-white py-12",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"bg-gray-800 flex justify-between items-start rounded-lg p-8 mb-8 border border-gray-700",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4 text-white",children:"Profile"}),(0,s.jsx)("p",{className:"text-gray-300",children:null==m?void 0:null===(e=m.user)||void 0===e?void 0:e.email})]}),(0,s.jsx)("div",{className:"bg-green-700 text-gray-300 px-3 py-1 rounded-full text-sm mt-2 inline-block",children:null==m?void 0:null===(r=m.user)||void 0===r?void 0:r.role})]}),(0,s.jsx)(c,{}),(0,s.jsxs)("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50 shadow-lg my-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Company Logos"}),(0,s.jsx)("div",{className:"h-px flex-1 bg-gray-700 mx-4"}),(0,s.jsxs)("label",{className:"relative cursor-pointer",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:w,className:"hidden",disabled:N}),(0,s.jsx)("span",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-lg font-medium hover:from-orange-700 hover:to-orange-800 transition-all duration-200 shadow-lg disabled:opacity-50",children:N?(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Add New Logo"})]})]}),(null==m?void 0:m.companyLogos)&&m.companyLogos.length>0?(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:m.companyLogos.map(e=>(0,s.jsxs)("div",{className:"group relative bg-gray-800/30 backdrop-blur-sm rounded-lg p-4 border border-gray-700/50 hover:bg-gray-800/50 transition-all duration-200",children:[(0,s.jsx)(h.default,{src:e.url,alt:e.name,width:e.width||200,height:e.height||200,className:"w-full h-32 object-contain rounded-lg"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-900/80 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-lg flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:[e.width,"x",e.height,"px"]})]})})]},e.id))}):(0,s.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No company logos uploaded yet"})]}),(0,s.jsx)("h2",{className:"text-3xl font-bold mt-8 mb-4 text-white",children:"Applicants"}),(null==x?void 0:x.length)>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow border border-gray-700 cursor-pointer",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white",children:e.firstName+" "+e.lastName}),(0,s.jsx)("p",{className:"text-gray-400",children:"Position"})]})}),(0,s.jsx)("p",{className:"text-gray-300 mb-4",children:e.email}),(0,s.jsx)("p",{className:"text-gray-300 mb-4",children:e.phone}),(0,s.jsx)("a",{href:"/applicant/".concat(null==e?void 0:e.cvId),className:"mt-4 block font-bold w-full text-center bg-orange-600 hover:bg-orange-400 text-white py-2 rounded-md transition-colors",children:"View Details"})]},e.cvId))}):(0,s.jsx)("p",{className:"text-xl",children:"No applicant added"}),(null==x?void 0:x.length)?(0,s.jsxs)("div",{className:"flex justify-end items-center my-4 space-x-4",children:[(0,s.jsx)("button",{onClick:()=>v(f-1),disabled:1===f,className:"rounded-full disabled:opacity-50 h-10 w-10 bg-gray-700 flex items-center justify-center",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",className:"w-5 h-5 text-white",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:[f," ",(0,s.jsxs)("span",{className:"opacity-50",children:["of ",b]})]}),(0,s.jsx)("button",{onClick:()=>v(f+1),disabled:f===b,className:"rounded-full h-10 w-10 disabled:opacity-50 bg-gray-700 flex items-center justify-center",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",className:"w-5 h-5 text-white",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M9 5l7 7-7 7"})})})]}):""]})})}},27923:(e,r,t)=>{"use strict";t.d(r,{K:()=>x});var s=t(2615);let a=(e,r)=>{r&&e.headers&&(e.headers.Authorization="Bearer ".concat(r))},l={token:null,expiry:0},i=async()=>{let e=Date.now();if(l.token&&l.expiry>e)return l.token;let r=await (0,s.getSession)();return r&&r.user.accessToken?(l.token=r.user.accessToken,l.expiry=e+3e5,l.token):null},n=e=>{e.interceptors.request.use(async e=>{try{let r=await i();r&&a(e,r)}catch(e){console.error("Error fetching token",e)}return e},e=>Promise.reject(e))};var o=t(82651);class d{async refreshToken(){return x.responseHandler(await x.get("auth/refresh"))}}let c=new d,u=async e=>{let r=await (0,s.getSession)(),t=null==r?void 0:r.user.refreshToken;e.interceptors.response.use(e=>e,async e=>{if(console.log("2 refresh ::::"),e.response){if(401===e.response.status){if(t)return await (0,s.getSession)().then(r=>{if(r){var t,s;(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.refreshToken)&&a(e.config,null==r?void 0:null===(s=r.user)||void 0===s?void 0:s.refreshToken)}}),c.refreshToken().then(e=>e).then(r=>(a(e.config,r.accessToken),o.A.request(e.config))).catch(()=>{});console.log("8 refresh ::::")}}else{if(console.log("3 refresh ::::"),"Network Error"===e.message)throw console.log("4 refresh ::::"),console.error("Network error - server is probably down"),e;throw console.log("5 refresh ::::"),console.error("Unknown error",e),e}return e.response})},h=function(e){if(e.status>=200&&e.status<300)return e;throw e.data};class g{static getInstance(){return g.instance||(g.instance=o.A.create({baseURL:"https://whale-app-z5sve.ondigitalocean.app/api/",timeout:12e4})),g.instance}}let m=e=>{n(e),u(e)};class p{responseHandler(e){let{data:r}=e;return r}async get(e,r){return h(await this._httpClient.get(e,r))}async post(e,r,t){return h(await this._httpClient.post(e,r,t))}async patch(e,r,t){return h(await this._httpClient.patch(e,r,t))}async put(e,r,t){return h(await this._httpClient.put(e,r,t))}async delete(e,r,t){let s=t||{};return r&&(s.data=r),h(await this._httpClient.delete(e,s))}constructor(){this._httpClient=g.getInstance(),m(this._httpClient)}}let x=new p},76046:(e,r,t)=>{"use strict";var s=t(66658);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},35482:(e,r,t)=>{"use strict";t.d(r,{ApplicantsProvider:()=>o,B:()=>d});var s=t(95155),a=t(12115),l=t(27923),i=t(2615);let n=(0,a.createContext)({applicants:[],loading:!1,error:null,page:1,setPage:()=>{},limit:6,setLimit:()=>{},type:"asc",setType:()=>{},technologies:[],setTechnologies:()=>{},pages:1,fetchApplicants:async()=>{}}),o=e=>{let{children:r}=e,[t,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),[g,m]=(0,a.useState)(1),[p,x]=(0,a.useState)(6),[f,v]=(0,a.useState)("asc"),[b,y]=(0,a.useState)([]),[N,j]=(0,a.useState)(1),{data:w,status:k}=(0,i.useSession)(),C=async()=>{c(!0);try{var e;if(null==w?void 0:null===(e=w.user)||void 0===e?void 0:e.accessToken){let e=await l.K.get("applicant",{params:{page:g,limit:p,type:f,technologies:b}});o(e.data.results||[]),j(e.data.pages||1)}}catch(e){console.error("Error fetching applicants:",e),h("Failed to fetch applicants.")}finally{c(!1)}};return(0,a.useEffect)(()=>{"authenticated"===k&&C()},[k,w,g,p,f,b]),(0,s.jsx)(n.Provider,{value:{applicants:t,loading:d,error:u,page:g,setPage:m,limit:p,setLimit:x,type:f,setType:v,technologies:b,setTechnologies:y,pages:N,fetchApplicants:C},children:r})},d=()=>(0,a.useContext)(n)},91620:(e,r,t)=>{"use strict";t.d(r,{ProfileProvider:()=>d,x:()=>c});var s=t(95155),a=t(12115),l=t(76046),i=t(2615),n=t(27923);let o=(0,a.createContext)({profile:null,loading:!1,fetchProfile:async()=>{}}),d=e=>{let{children:r}=e,t=(0,l.useRouter)(),{data:d,status:c}=(0,i.useSession)(),[u,h]=(0,a.useState)(null),[g,m]=(0,a.useState)(!0),p=async()=>{m(!0);try{var e;if(null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.accessToken){let e=await n.K.get("user/profile");h(e.data)}}catch(e){console.error("Error fetching profile data:",e)}finally{m(!1)}};return(0,a.useEffect)(()=>{if("unauthenticated"===c){t.replace("/");return}"authenticated"===c&&p()},[c,d,t]),(0,s.jsx)(o.Provider,{value:{profile:u,loading:g,fetchProfile:p},children:r})},c=()=>(0,a.useContext)(o)}},e=>{var r=r=>e(e.s=r);e.O(0,[825,565,606,441,517,358],()=>r(75254)),_N_E=e.O()}]);